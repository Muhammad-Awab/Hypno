@page "/registration"
@using Hypnos.Data.Entities;
@using Hypnos.Data.DAL;

@inject NavigationManager navigationManager;

<style>
    .row {
        min-height: 90vh;
    }
</style>
<div class="container">
    <div class="row align-items-center">
        <div class="col-md-8">
            <div class="">
                <div class="text-center">
                    <img src="images/logo.png" width="350" />
                    <p class="h5">
                        Comprehensive healthcare, from dusk until dawn<br />We help the world sleep
                    </p>
                </div>
            </div>

        </div>
        <div class="col-md-4 mt-5">
            <div class="login-top-height">
                <div class="card text-center">
                    <div class="card-body shadow-lg">
                        @if (@check)
                        {
                            <label>Username & password are incorrect</label>
                        }
                        <input type="text" placeholder="Enter username" class="form-control mb-2" @bind-value="Lname" />
                        <input type="password" placeholder="Enter password" class="form-control mb-2" @bind-value="Lpassword" />


                        <div>
                            <button type="button" class="btn btn-danger form-control" @onclick="e=>Login(Lname,Lpassword)">
                                Login
                            </button>
                            <p class="text-primary border-bottom pb-3 pt-2">Forgotton password?</p>
                            <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#exampleModalCenter">
                                Create New Account
                            </button>

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
<!-- Button trigger modal -->
<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalCenterTitle">Registration</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <input type="text" placeholder="Enter your username" class="form-control mb-2" @bind-value="_Model.UserName" />
                <input type="password" placeholder="Enter Password" class="form-control mb-2" @bind-value="_Model.Password" />
                <input type="text" placeholder="Enter Name" class="form-control mb-2" @bind-value="_Model.Name" />
                <input type="radio" name="gender" value="Male" /> Male
                <input type="radio" name="gender" value="Female" /> Female
                @*<input type="text" placeholder="Enter your email" class="form-control mb-2" @bind-value="_Model.Email" />*@
                <input type="date" placeholder="Enter Date of Birth" class="form-control mb-2" @bind-value="_Model.DOB" />
                <input type="text" placeholder="Enter your weight" class="form-control mb-2" @bind-value="_Model.Weight" />
                <input type="text" placeholder="Enter your height" class="form-control mb-2" @bind-value="_Model.Height" />
                <input type="text" placeholder="Enter BMI" class="form-control mb-2" @bind-value="_Model.BMI" />
                <input type="text" placeholder="Enter Payment Information" class="form-control mb-2" @bind-value="_Model.Payment_Info" />
                <input type="text" placeholder="Enter Neck circumference" class="form-control mb-2" @bind-value="_Model.Neck_Circumference" />
                <input type="text" placeholder="Enter Pharmacy" class="form-control mb-2" @bind-value="_Model.Pharmacy" />
                <input type="text" placeholder="Enter Address" class="form-control mb-2" @bind-value="_Model.Address" />
                <label>Are the any allergy</label>
                <input type="radio" name="gender" value="Male" /> Yes
                <input type="radio" name="gender" value="Female" /> No
                <div class="mt-3">
                    <p class="text-black-50" style="font-size:12px">
                        By clicking Register, you agree to our Terms, Privacy Policy and Cookies Policy. You may receive EMAIL notifications from us and can opt out at any time.
                    </p>
                    <button class="btn btn-danger mt-2 form-control" data-dismiss="modal" @onclick="e=>submit()">Register</button>
                </div>
            </div>
        </div>
    </div>

</div>

@code {

    public string? Lname { get; set; }
    public string? _name { get; set; }
    public string? name { get; set; }


    public string? _password { get; set; }

    public string? Lpassword { get; set; }

    public bool check { get; set; } = false;

    public EntUserLogin _Model { get; set; } = new EntUserLogin();
    public List<EntUserLogin> UserList = new List<EntUserLogin>();

    protected override void OnInitialized()
    {

    }

    private void submit()
    {
        DALUserLogin.SaveSignUp(_Model);
    }


    void SendInformation(string na, string pass)
    {
        _name = na;
        _password = pass;
    }
    private void Login(string na, string pass)
    {
        UserList = DALUserLogin.GetUserByName(na);

        foreach (var emp in UserList)
        {
            if (emp.UserName == na && emp.Password == pass)
            {
                navigationManager.NavigateTo("demographic");
            }
            else
            {
                check = true;
            }

        }

    }
}
